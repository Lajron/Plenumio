@model FeedFilterQuery

<div>
    <form asp-controller="Feed" asp-action="Index" method="get" class="d-flex justify-content-between align-items-center w-100 m-0 p-0">

        @* Preserve current state *@
        <input type="hidden" name="Scope" value="@Model.Scope" />
        <input type="hidden" name="Search" value="@Model.Search" />
        <input type="hidden" name="Tag" value="@Model.Tag" />

        @* Left: Sort + PostType as icons *@
        <div class="d-flex align-items-center gap-2">

            <div class="dropdown">
                <button class="btn btn-link p-0 text-primary" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Sort">
                    <i class="bi bi-sort-alpha-down fs-5"></i>
                </button>
                <ul class="dropdown-menu">
                    @foreach (SortType sort in Enum.GetValues(typeof(SortType))) {
                        <li>
                            <button class="dropdown-item" type="submit" name="Sort" value="@sort">@sort</button>
                        </li>
                    }
                </ul>
            </div>

            <div class="dropdown">
                <button class="btn btn-link p-0 text-primary" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Post Type">
                    <i class="bi bi-file-earmark-text fs-5"></i>
                </button>
                <ul class="dropdown-menu">
                    <li><button class="dropdown-item" type="submit" name="PostType" value="">All</button></li>
                    <li><button class="dropdown-item" type="submit" name="PostType" value="Standard">Post</button></li>
                    <li><button class="dropdown-item" type="submit" name="PostType" value="Media">Media</button></li>
                    <li><button class="dropdown-item" type="submit" name="PostType" value="Article">Article</button></li>
                </ul>
            </div>

        </div>

        @* Right: Date icon dropdown *@
        <div class="dropdown">
            <button class="btn btn-link p-0 text-primary" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Date Range">
                <i class="bi bi-calendar-event fs-5"></i>
            </button>
            <ul class="dropdown-menu">
                @{
                    var today = DateTime.Now.Date;
                    var ranges = new Dictionary<string, bool> {
                        [""] = !Model.FromDate.HasValue,
                        ["Week"] = Model.FromDate.HasValue && Model.FromDate.Value.Date >= today.AddDays(-7),
                        ["Month"] = Model.FromDate.HasValue && Model.FromDate.Value.Date >= today.AddMonths(-1),
                        ["3Months"] = Model.FromDate.HasValue && Model.FromDate.Value.Date >= today.AddMonths(-3),
                        ["6Months"] = Model.FromDate.HasValue && Model.FromDate.Value.Date >= today.AddMonths(-6),
                        ["Year"] = Model.FromDate.HasValue && Model.FromDate.Value.Date >= today.AddYears(-1)
                    };
                    var labels = new Dictionary<string, string> {
                        [""] = "All",
                        ["Week"] = "This Week",
                        ["Month"] = "This Month",
                        ["3Months"] = "Last 3 Months",
                        ["6Months"] = "Last 6 Months",
                        ["Year"] = "Last Year"
                    };
                }
                @foreach (var r in ranges) {
                    <li>
                        <button class="dropdown-item" type="submit" name="DateRange" value="@r.Key">
                            @labels[r.Key]
                        </button>
                    </li>
                }
            </ul>
        </div>

    </form>
</div>
